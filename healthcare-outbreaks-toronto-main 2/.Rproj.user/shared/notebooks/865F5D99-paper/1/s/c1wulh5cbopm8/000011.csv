"0","#| echo: false"
"0","#| warning: false"
"0","#| label: fig-organization-shelters-chart"
"0","#| fig-cap: ""Pie Chart of Shelters by Organization (Grouped)"""
"0",""
"0","#### Third Graph ####"
"0",""
"0","# Group small categories into ""Other"""
"0","threshold <- 5  # Set a threshold for grouping small categories"
"0","data_summary <- data %>%"
"0","  group_by(ORGANIZATION_NAME) %>%"
"0","  summarise(Count = n()) %>%"
"0","  mutate(Percentage = Count / sum(Count) * 100) %>%"
"0","  mutate(ORGANIZATION_NAME = ifelse(Percentage < threshold, ""Other"", ORGANIZATION_NAME)) %>%"
"0","  group_by(ORGANIZATION_NAME) %>%"
"0","  summarise(Count = sum(Count), Percentage = sum(Percentage))"
"0",""
"0","# Pie chart with grouped smaller categories"
"0","ggplot(data_summary, aes(x="""", y=Percentage, fill=ORGANIZATION_NAME)) +"
"0","  geom_bar(stat=""identity"", width=1, color=""white"") +"
"0","  coord_polar(theta=""y"") +"
"0","  labs(title=""Pie Chart of Shelters by Organization (Grouped)"") +"
"0","  theme_void() +  # Remove grid lines and axis"
"0","  theme("
"0","    plot.title = element_text(size=16, face=""bold""),"
"0","    legend.title = element_text(size=12),"
"0","    legend.text = element_text(size=10)"
"0","  ) +"
"0","  geom_text(aes(label = paste0(round(Percentage, 1), ""%"")), "
"0","            position = position_stack(vjust = 0.5), color = ""white"")"
"0",""
